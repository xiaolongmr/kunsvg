<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>SVG 图标复制工具</title>

  <!-- 外部资源 -->
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- 引入JSZip用于压缩文件 -->
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
  <!-- 引入FileSaver用于保存文件 -->
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
  <!-- 引入html2canvas用于转换为图片 -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <!-- 引入SVG.js用于SVG操作 -->
  <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.js@3.2/dist/svg.min.js"></script>
  <!-- 图标资源 js版 -->
  <script src="https://cdn2.codesign.qq.com/icons/N292J6opgMn8G9a/latest/iconfont.js"></script>

  <!-- 本地样式文件 -->
  <link rel="stylesheet" href="css/styles.css">

  <!-- Prism.js 语法高亮库 -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

  <!-- Tailwind 配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#409eff',
            secondary: '#67c23a',
            neutral: {
              100: '#f5f7fa',
              200: '#e4e7ed',
              300: '#dcdfe6',
              800: '#303133',
              900: '#1e1e20'
            }
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
</head>

<body class="font-inter bg-neutral-100 text-neutral-800 min-h-screen transition-basic">
  <!-- 顶部导航 -->
  <header class="bg-white shadow-sm py-4 px-6 sticky top-0 z-30">
    <div class="container mx-auto flex flex-wrap justify-between items-center gap-4">
      <div class="flex items-center space-x-2">
        <div class="logo-container">
          <i class="fa fa-cube text-primary logo-icon"></i>
          <div class="logo-glow"></div>
        </div>
        <h1 class="text-xl font-bold">沐风图标库</h1>
      </div>

      <div class="flex items-center gap-3 w-full md:w-auto">
        <!-- 搜索框 -->
        <div class="relative flex-grow md:flex-grow-0 md:w-64">
          <i class="fa fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
          <input type="text" id="searchInput" placeholder="搜索图标..."
            class="w-full pl-10 pr-4 py-2 rounded-lg border border-neutral-200 focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary transition-basic">
        </div>

        <!-- 随机颜色和重置颜色按钮组 -->
        <div class="flex border border-neutral-200 rounded-full overflow-hidden">
          <button id="randomColorsBtn" class="p-2 hover:bg-neutral-100 transition-basic" title="随机颜色">
            <i class="fa fa-random text-neutral-600"></i>
          </button>
          <button id="resetAllColorsBtn" class="p-2 hover:bg-neutral-100 transition-basic border-l border-neutral-200"
            title="重置所有颜色">
            <i class="fa fa-refresh text-neutral-600"></i>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- 主内容区 -->
  <main class="container mx-auto px-6 py-8">
    <!-- 统计和操作区 -->
    <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
      <p class="text-sm text-gray-500">
        共 <span id="iconCount" class="text-primary font-medium">0</span> 个图标
        <span id="selectedCount" class="ml-2 text-gray-500 hidden">
          (已选择 <span class="text-primary font-medium">0</span> 个)
        </span>
      </p>
      <div class="flex flex-wrap gap-2">
        <!-- 分组筛选 -->
        <div class="relative">
          <select id="groupFilter" class="filter-select">
            <option value="all">所有图标</option>
            <option value="linear">线性图标 (-x)</option>
            <option value="filled">面性图标 (-m)</option>
            <option value="delicate">精美图标 (-jm)</option>
            <option value="handdrawn">手绘图标 (-sh)</option>
            <option value="flat">扁平图标 (-bp)</option>
            <option value="minimal">简约图标 (-jy)</option>
            <option value="other">其他图标</option>
          </select>
        </div>

        <button id="deselectAllBtn"
          class="text-sm bg-white border border-neutral-200 hover:bg-neutral-100 px-3 py-1.5 rounded-lg transition-basic flex items-center gap-1 hidden">
          <i class="fa fa-times"></i>
          <span>取消选择</span>
        </button>
        <button id="downloadSelectedBtn"
          class="text-sm bg-secondary text-white hover:bg-secondary/90 px-3 py-1.5 rounded-lg transition-basic flex items-center gap-1 hidden">
          <i class="fa fa-download"></i>
          <span>下载所选</span>
        </button>
        <button id="downloadAllBtn"
          class="text-sm bg-primary text-white hover:bg-primary/90 px-3 py-1.5 rounded-lg transition-basic flex items-center gap-1">
          <i class="fa fa-download"></i>
          <span>下载全部</span>
        </button>
        <button id="refreshBtn"
          class="text-sm bg-white border border-neutral-200 hover:bg-neutral-100 px-3 py-1.5 rounded-lg transition-basic flex items-center gap-1">
          <i class="fa fa-refresh"></i>
          <span>刷新</span>
        </button>
      </div>
    </div>

    <!-- 多选提示 - 通用版本 -->
    <div class="bg-blue-50 border-l-4 border-primary p-4 mb-6 rounded-r text-sm">
      <div class="flex items-start">
        <i class="fa fa-info-circle text-primary mt-0.5 mr-2"></i>
        <p>按住 <kbd class="px-2 py-0.5 bg-white border rounded text-xs">Ctrl</kbd> 或 <kbd
            class="px-2 py-0.5 bg-white border rounded text-xs">Cmd</kbd> 键点击图标可进行多选，选好后可批量下载</p>
      </div>
    </div>

    <!-- 图标网格 -->
    <div id="iconGrid" class="icon-grid">
      <!-- 加载状态 -->
      <div class="col-span-full flex justify-center items-center py-20">
        <div class="flex flex-col items-center">
          <div class="w-10 h-10 border-4 border-primary border-t-transparent rounded-full animate-spin mb-3"></div>
          <p class="text-gray-500">加载图标中...</p>
        </div>
      </div>
    </div>

    <!-- 加载更多 -->
    <div id="loadMoreContainer" class="loading-more hidden">
      <div class="loading-state flex flex-col items-center">
        <div class="w-6 h-6 border-4 border-primary border-t-transparent rounded-full animate-spin mb-2"></div>
        <p class="text-sm text-gray-500">加载更多图标...</p>
      </div>
      <div class="end-state hidden flex flex-col items-center">
        <p class="load-more-end">已加载全部图标</p>
      </div>
      <div class="error-state hidden flex flex-col items-center">
        <p class="text-sm text-red-500 mb-2">加载失败</p>
        <button id="retryLoadBtn"
          class="text-xs bg-primary text-white px-2 py-1 rounded hover:bg-primary/90 transition-basic">
          重试
        </button>
      </div>
    </div>
  </main>

  <!-- 图标详情模态框 -->
  <div id="iconModal"
    class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center opacity-0 pointer-events-none transition-basic">
    <div
      class="bg-white rounded-xl shadow-xl max-w-5xl w-full mx-4 transform scale-95 transition-basic max-h-[90vh] overflow-y-auto">
      <div class="p-5 border-b border-neutral-200 flex justify-between items-center">
        <h3 class="text-lg font-semibold" id="modalTitle">图标详情</h3>
        <button id="closeModal" class="text-neutral-500 hover:text-neutral-800 transition-basic">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <div class="p-5">
        <!-- 优化布局：使用更紧凑的网格系统 -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <!-- 图标预览 - 占据左侧一列 -->
          <div class="lg:col-span-1">
            <div class="detail-preview-container">
              <div class="detail-icon-wrapper">
                <div id="modalIconPreview" class="detail-icon-container"></div>
              </div>
              <div class="preview-controls">
                <div class="preview-info">
                  <!-- 预览文字已移除 -->
                </div>
              </div>
            </div>
          </div>

          <!-- 图标信息和操作 - 占据右侧两列 -->
          <div class="lg:col-span-2">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-5">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">图标名称</label>
                <p id="modalIconName" class="font-medium"></p>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">图标分组</label>
                <p id="modalIconGroup" class="font-medium"></p>
              </div>
            </div>

            <!-- 新增：尺寸选择器 -->
            <div class="mb-5 p-4 bg-neutral-50 rounded-lg">
              <label class="block text-sm font-medium text-gray-700 mb-2">选择尺寸 (适用于 PNG)</label>
              <div class="flex flex-wrap gap-2" id="sizeOptions">
                <div class="size-option size-option-selected" data-size="64">64x64</div>
                <div class="size-option" data-size="128">128x128</div>
                <div class="size-option" data-size="256">256x256</div>
                <div class="size-option" data-size="512">512x512</div>
              </div>
            </div>

            <!-- 颜色选择器 - 更紧凑的布局 -->
            <div class="mb-5 p-4 bg-neutral-50 rounded-lg">
              <div class="flex justify-between items-center mb-3">
                <label class="block text-sm font-medium text-gray-700">图标颜色</label>
                <div class="flex gap-2">
                  <button id="randomPathColorBtn"
                    class="text-xs px-2 py-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded hover:from-purple-600 hover:to-pink-600 transition-all">
                    <i class="fa fa-random mr-1"></i>路径随机上色
                  </button>
                  <button id="resetColorBtn" class="text-xs text-primary hover:text-primary/80 transition-basic">
                    <i class="fa fa-refresh mr-1"></i>重置颜色
                  </button>
                </div>
              </div>

              <!-- 同步开关 -->
              <div class="flex justify-between items-center mb-3 p-2 bg-blue-50 rounded">
                <div class="flex items-center gap-2">
                  <i class="fa fa-sync-alt text-blue-500"></i>
                  <span class="text-sm text-gray-700">与首页图标同步</span>
                  <span class="text-xs text-gray-500">(修改颜色时同步更新首页图标)</span>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" id="syncWithHomePage" class="sr-only peer" checked>
                  <div
                    class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
                  </div>
                </label>
              </div>

              <!-- 自定义颜色选择器 -->
              <div class="mb-3">
                <div id="customColorPicker"></div>
              </div>

              <!-- 预设颜色选项 -->
              <div class="flex gap-1 flex-wrap mb-3">
                <div class="color-option" style="background-color: #409eff;" data-color="#409eff"></div>
                <div class="color-option" style="background-color: #303133;" data-color="#303133"></div>
                <div class="color-option" style="background-color: #ffffff; border: 1px solid #e4e7ed;"
                  data-color="#ffffff"></div>
                <div class="color-option" style="background-color: #f56c6c;" data-color="#f56c6c"></div>
                <div class="color-option" style="background-color: #67c23a;" data-color="#67c23a"></div>
                <div class="color-option" style="background-color: #e6a23c;" data-color="#e6a23c"></div>
              </div>

              <!-- 路径2颜色选择器 -->
              <div class="mb-3 p-3 bg-white rounded border border-gray-200">
                <div class="flex justify-between items-center mb-2">
                  <label class="block text-sm font-medium text-gray-700">路径 2 颜色</label>
                  <div class="text-xs text-gray-500">点击预览图标中的路径可单独编辑颜色</div>
                </div>
                <div class="flex gap-1 flex-wrap">
                  <div class="path2-color-option w-6 h-6 rounded cursor-pointer border border-gray-300"
                    style="background-color: #409eff;" data-color="#409eff" title="蓝色"></div>
                  <div class="path2-color-option w-6 h-6 rounded cursor-pointer border border-gray-300"
                    style="background-color: #303133;" data-color="#303133" title="黑色"></div>
                  <div class="path2-color-option w-6 h-6 rounded cursor-pointer border border-gray-300"
                    style="background-color: #f56c6c;" data-color="#f56c6c" title="红色"></div>
                  <div class="path2-color-option w-6 h-6 rounded cursor-pointer border border-gray-300"
                    style="background-color: #67c23a;" data-color="#67c23a" title="绿色"></div>
                  <div class="path2-color-option w-6 h-6 rounded cursor-pointer border border-gray-300"
                    style="background-color: #e6a23c;" data-color="#e6a23c" title="橙色"></div>
                </div>
                <div class="mt-2 text-xs text-gray-500">
                  提示：点击预览图标中的路径可单独修改其颜色
                </div>
              </div>

              <p class="text-xs text-gray-500">提示：点击预览图中的路径可单独修改其颜色</p>
            </div>

            <!-- 当前选中路径信息已移除，使用新的路径选择方式 -->

            <!-- SVG代码区域 - 优化高度和布局 -->
            <div class="mb-5">
              <label class="block text-sm font-medium text-gray-700 mb-1">SVG 代码</label>
              <div class="relative">
                <pre id="svgCode"
                  class="language-markup bg-neutral-900 text-white p-3 rounded-lg text-sm overflow-x-auto max-h-32 text-xs whitespace-pre-wrap break-all"><code class="language-markup"></code></pre>
                <button id="copySvgBtn"
                  class="absolute top-2 right-2 bg-black/90 hover:bg-black text-white px-2 py-1 rounded text-xs transition-basic">
                  复制
                </button>
              </div>
            </div>

            <!-- 操作按钮区域 - 添加复制图片按钮 -->
            <div class="flex gap-3 flex-wrap pt-2 border-t border-neutral-100">
              <button id="downloadSvgBtn"
                class="bg-primary hover:bg-primary/90 text-white text-sm px-4 py-2 rounded-lg transition-basic flex items-center gap-1">
                <i class="fa fa-download"></i>
                <span>下载 SVG</span>
              </button>
              <button id="downloadPngBtn"
                class="bg-orange-500 hover:bg-orange-600 text-white text-sm px-4 py-2 rounded-lg transition-basic flex items-center gap-1">
                <i class="fa fa-download"></i>
                <span>下载 PNG</span>
              </button>
              <!-- 新增：复制图片到剪贴板按钮 -->
              <button id="copyImageBtn" class="copy-image-btn">
                <i class="fa fa-image"></i>
                <span>复制PNG</span>
              </button>
              <button id="copyDirectBtn"
                class="bg-black hover:bg-gray-800 text-white text-sm px-4 py-2 rounded-lg transition-basic flex items-center gap-1">
                <i class="fa fa-copy"></i>
                <span>复制代码</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 下载设置模态框 -->
  <div id="downloadSettingsModal"
    class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center opacity-0 pointer-events-none transition-basic">
    <div
      class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4 transform scale-95 transition-basic max-h-[90vh] overflow-y-auto">
      <div class="p-5 border-b border-neutral-200 flex justify-between items-center">
        <h3 class="text-lg font-semibold">下载设置</h3>
        <button id="closeDownloadModal" class="text-neutral-500 hover:text-neutral-800 transition-basic">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <div class="p-5">
        <!-- 导出格式选择 -->
        <div class="mb-5">
          <label class="block text-sm font-medium text-gray-700 mb-2">导出格式</label>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="checkbox" id="exportSvg" class="size-checkbox">
              <span class="ml-2 text-sm text-gray-700">SVG 格式</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" id="exportPng" class="size-checkbox" checked="">
              <span class="ml-2 text-sm text-gray-700">PNG 格式</span>
            </label>
          </div>
        </div>

        <!-- 导出尺寸选择 -->
        <div class="mb-5">
          <label class="block text-sm font-medium text-gray-700 mb-2">导出尺寸 (适用于 PNG)</label>
          <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
            <label class="flex items-center">
              <input type="checkbox" name="exportSizes" value="64" class="size-checkbox">
              <span class="ml-2 text-sm text-gray-700">64x64</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" name="exportSizes" value="128" class="size-checkbox" checked="">
              <span class="ml-2 text-sm text-gray-700">128x128</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" name="exportSizes" value="256" class="size-checkbox">
              <span class="ml-2 text-sm text-gray-700">256x256</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" name="exportSizes" value="512" class="size-checkbox" checked="">
              <span class="ml-2 text-sm text-gray-700">512x512</span>
            </label>
          </div>
        </div>

        <!-- 打包选项 -->
        <div class="mb-5">
          <label class="block text-sm font-medium text-gray-700 mb-2">打包选项</label>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="radio" name="packagingOption" value="by-icon" class="size-checkbox">
              <span class="ml-2 text-sm text-gray-700">按图标分组（每个图标一个文件夹）</span>
            </label>
            <label class="flex items-center">
              <input type="radio" name="packagingOption" value="by-format-size" class="size-checkbox" checked="">
              <span class="ml-2 text-sm text-gray-700">按格式和尺寸分组（相同格式和尺寸打包在一起）</span>
            </label>
            <label class="flex items-center">
              <input type="radio" name="packagingOption" value="single-folder" class="size-checkbox">
              <span class="ml-2 text-sm text-gray-700">一个文件夹下载所有</span>
            </label>
          </div>
        </div>

        <!-- 颜色设置 -->
        <div class="mb-4">
          <label class="flex items-center">
            <input type="checkbox" id="useIndividualColors" class="size-checkbox" checked="">
            <span class="ml-2 text-sm text-gray-700">使用单独设置的图标颜色</span>
          </label>
        </div>

        <div id="batchColorContainer" class="mb-5">
          <label class="block text-sm font-medium text-gray-700 mb-2">统一图标颜色 (如不使用单独颜色)</label>
          <div class="flex items-center gap-3">
            <div class="color-picker">
              <input type="color" id="batchColorPicker" value="#409eff" class="w-full h-full cursor-pointer">
            </div>
            <div class="flex gap-1 flex-wrap">
              <div class="color-option" style="background-color: #409eff;" data-color="#409eff"></div>
              <div class="color-option" style="background-color: #303133;" data-color="#303133"></div>
              <div class="color-option" style="background-color: #ffffff; border: 1px solid #e4e7ed;"
                data-color="#ffffff"></div>
              <div class="color-option" style="background-color: #f56c6c;" data-color="#f56c6c"></div>
            </div>
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-3 border-t border-neutral-200">
          <button id="cancelDownloadBtn"
            class="bg-white border border-neutral-200 hover:bg-neutral-100 text-sm px-4 py-2 rounded-lg transition-basic">
            取消
          </button>
          <button id="confirmDownloadBtn"
            class="bg-secondary hover:bg-secondary/90 text-white text-sm px-4 py-2 rounded-lg transition-basic">
            确认下载
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- 提示框 -->
  <div id="toast"
    class="fixed bottom-6 right-6 px-4 py-2 rounded-lg shadow-lg transform translate-y-10 opacity-0 transition-basic flex items-center gap-2 z-50">
  </div>

  <!-- 隐藏的PNG转换容器 -->
  <div id="pngConversionContainer" class="hidden absolute top-0 left-0 z-0"></div>

  <!-- 本地脚本文件 -->
  <script src="js/syntax-highlight.js"></script>
  <script src="js/svg-color-manager.js"></script>
  <script src="js/color-manager.js"></script>
  <script src="js/download-manager.js"></script>
  <script src="js/ps-plugin-utils.js"></script>
  <script src="js/main.js"></script>
</body>

</html>